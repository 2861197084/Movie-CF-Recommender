# MovieLens ååŒè¿‡æ»¤æ¨èç³»ç»Ÿ

åŸºäº MovieLens æ•°æ®é›†çš„å­¦æœ¯çº§ååŒè¿‡æ»¤ç®—æ³•å®ç°ã€‚æœ¬é¡¹ç›®éµå¾ªè½¯ä»¶å·¥ç¨‹æœ€ä½³å®è·µå’Œå­¦æœ¯ç ”ç©¶æ ‡å‡†ï¼Œæä¾›å¯é‡ç°çš„ç»¼åˆåˆ†ææ¡†æ¶ã€‚

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

æœ¬ç³»ç»Ÿæä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š

- **ç”¨æˆ·ååŒè¿‡æ»¤ç®—æ³•**ï¼šåŸºäºç›¸ä¼¼ç”¨æˆ·åå¥½è¿›è¡Œæ¨è
- **ç‰©å“ååŒè¿‡æ»¤ç®—æ³•**ï¼šåŸºäºç‰©å“ç›¸ä¼¼æ€§è¿›è¡Œæ¨è
- **ç»¼åˆè¯„ä¼°ä½“ç³»**ï¼šå¤šç§å­¦æœ¯æ ‡å‡†è¯„ä¼°æŒ‡æ ‡ï¼ˆMAEã€RMSEã€Precision@Kã€Recall@Kã€NDCG@Kï¼‰
- **å­¦æœ¯çº§å¯è§†åŒ–**ï¼šå‘è¡¨çº§å›¾è¡¨å’Œäº¤äº’å¼ä»ªè¡¨æ¿
- **å¯é‡ç°ç ”ç©¶**ï¼šè¯¦ç»†æ—¥å¿—è®°å½•ã€é…ç½®ç®¡ç†å’Œç»Ÿè®¡åˆ†æ

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

```bash
python >= 3.8
pip install -r requirements.txt
```

### å®‰è£…æ–¹æ³•

```bash
git clone <repository-url>
cd Movie-CF-Recommender
pip install -r requirements.txt
```

### åŸºæœ¬ä½¿ç”¨

```bash
# è¿è¡Œå®Œæ•´å®éªŒï¼ˆè‡ªåŠ¨ä¸‹è½½æ•°æ®é›†ï¼‰
python main.py

# å¿«é€Ÿæµ‹è¯•ï¼ˆè‡ªåŠ¨ä¸‹è½½ ml-latest-smallï¼‰
python main.py --quick-test

# ä½¿ç”¨ä¸åŒæ•°æ®é›†ï¼ˆè‡ªåŠ¨ä¸‹è½½ï¼‰
python main.py --dataset ml-25m

# è‡ªå®šä¹‰å®éªŒåç§°
python main.py --experiment-name "æˆ‘çš„å®éªŒ"

# ç¦ç”¨è‡ªåŠ¨ä¸‹è½½ï¼ˆéœ€è¦æ‰‹åŠ¨å‡†å¤‡æ•°æ®ï¼‰
python main.py --no-download --data-path "/path/to/movielens/data"
```

# è¶…å‚æ•°ä¼˜åŒ–
python main.py --hyperparameter-search --search-method grid_search

# å¿«é€Ÿè¶…å‚æ•°æœç´¢æµ‹è¯•
python main.py --hyperparameter-search --quick-test --cv-folds 3

# éšæœºæœç´¢è¶…å‚æ•°ä¼˜åŒ–
python main.py --hyperparameter-search --search-method random_search --n-trials 100
```

## ğŸ†• è¶…å‚æ•°åˆ†æåŠŸèƒ½

ç³»ç»Ÿç°åœ¨æ”¯æŒå®Œæ•´çš„è¶…å‚æ•°ä¼˜åŒ–å’Œå­¦æœ¯åˆ†æï¼š

### ä¸»è¦ç‰¹æ€§
- **ç½‘æ ¼æœç´¢å’Œéšæœºæœç´¢**ï¼šæ”¯æŒç³»ç»ŸåŒ–çš„è¶…å‚æ•°ç©ºé—´æ¢ç´¢
- **äº¤å‰éªŒè¯è¯„ä¼°**ï¼šk-æŠ˜äº¤å‰éªŒè¯ç¡®ä¿ç»“æœç¨³å®šæ€§
- **ç»Ÿè®¡æ˜¾è‘—æ€§æµ‹è¯•**ï¼šWilcoxonæ£€éªŒéªŒè¯ç»“æœå¯ä¿¡åº¦
- **å­¦æœ¯çº§å¯è§†åŒ–**ï¼šVMambaé£æ ¼çš„ä¸“ä¸šå›¾è¡¨åˆ†æ
- **è‡ªåŠ¨æŠ¥å‘Šç”Ÿæˆ**ï¼šLaTeXå’ŒMarkdownæ ¼å¼çš„å­¦æœ¯æŠ¥å‘Š

### è¶…å‚æ•°æœç´¢ç©ºé—´
- é‚»å±…æ•°é‡ (k)ï¼š[10, 20, 30, 50, 75, 100]
- ç›¸ä¼¼åº¦æŒ‡æ ‡ï¼šcosine, pearson
- æ•°æ®é¢„å¤„ç†å‚æ•°ï¼šæœ€å°è¯„åˆ†é˜ˆå€¼
- è®­ç»ƒæ¯”ä¾‹ï¼š[0.7, 0.8, 0.9]

### ä½¿ç”¨ç¤ºä¾‹

```bash
# å®Œæ•´è¶…å‚æ•°ä¼˜åŒ–
python main.py --hyperparameter-search

# è‡ªå®šä¹‰æœç´¢å‚æ•°
python main.py --hyperparameter-search \
               --search-method random_search \
               --n-trials 50 \
               --cv-folds 5
```

### æ”¯æŒçš„æ•°æ®é›†

ç³»ç»Ÿå¯è‡ªåŠ¨ä¸‹è½½å’Œå¤„ç†å¤šç§ MovieLens æ•°æ®é›†ï¼š

- `ml-latest-small`ï¼šçº¦10ä¸‡è¯„åˆ†ï¼ˆé»˜è®¤ï¼Œæ¨èæµ‹è¯•ä½¿ç”¨ï¼‰
- `ml-latest`ï¼šçº¦2700ä¸‡è¯„åˆ†ï¼ˆå®Œæ•´æ•°æ®é›†ï¼‰
- `ml-25m`ï¼š2500ä¸‡è¯„åˆ†ï¼ˆç¨³å®šç‰ˆæœ¬ï¼‰
- `ml-100k`ï¼š10ä¸‡è¯„åˆ†ï¼ˆç»å…¸æ ¼å¼ï¼‰

## ğŸ“ é¡¹ç›®ç»“æ„

```
Movie-CF-Recommender/
â”œâ”€â”€ config.py                 # é…ç½®ç®¡ç†
â”œâ”€â”€ main.py                   # ä¸»æ‰§è¡Œè„šæœ¬
â”œâ”€â”€ requirements.txt          # Python ä¾èµ–åŒ…
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ logger.py             # å­¦æœ¯çº§æ—¥å¿—ç³»ç»Ÿ
â”‚   â”œâ”€â”€ data_loader.py        # MovieLens æ•°æ®å¤„ç†
â”‚   â””â”€â”€ dataset_downloader.py # è‡ªåŠ¨æ•°æ®é›†ä¸‹è½½
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ base_cf.py            # ååŒè¿‡æ»¤åŸºç±»
â”‚   â”œâ”€â”€ user_based_cf.py      # ç”¨æˆ·ååŒè¿‡æ»¤å®ç°
â”‚   â””â”€â”€ item_based_cf.py      # ç‰©å“ååŒè¿‡æ»¤å®ç°
â”œâ”€â”€ evaluation/
â”‚   â””â”€â”€ metrics.py            # ç»¼åˆè¯„ä¼°æŒ‡æ ‡
â”œâ”€â”€ analysis/
â”‚   â””â”€â”€ visualizer.py         # å­¦æœ¯å¯è§†åŒ–å¥—ä»¶
â””â”€â”€ data/                     # æ•°æ®é›†ç›®å½•ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
    â”œâ”€â”€ ratings.csv           # MovieLens è¯„åˆ†æ•°æ®
    â””â”€â”€ movies.csv            # MovieLens ç”µå½±æ•°æ®
```

## ğŸ“Š ç®—æ³•å®ç°

### ç”¨æˆ·ååŒè¿‡æ»¤ç®—æ³•

åŸºäºç›¸ä¼¼ç”¨æˆ·çš„è¯„åˆ†æ¨¡å¼è¿›è¡Œæ¨èã€‚

**æ•°å­¦åŸºç¡€ï¼š**
```
rÌ‚(u,i) = rÌ„(u) + Î£(sim(u,v) * (r(v,i) - rÌ„(v))) / Î£|sim(u,v)|
```

**ç®—æ³•ç‰¹æ€§ï¼š**
- å¤šç§ç›¸ä¼¼åº¦åº¦é‡ï¼ˆä½™å¼¦ã€çš®å°”é€Šã€Jaccardï¼‰
- å‡å€¼ä¸­å¿ƒåŒ–å‡å°‘åç½®
- å¯é…ç½®é‚»åŸŸå¤§å°
- å¤„ç†å†·å¯åŠ¨é—®é¢˜

### ç‰©å“ååŒè¿‡æ»¤ç®—æ³•

æ¨èä¸ç”¨æˆ·é«˜è¯„åˆ†ç‰©å“ç›¸ä¼¼çš„å…¶ä»–ç‰©å“ã€‚

**æ•°å­¦åŸºç¡€ï¼š**
```
rÌ‚(u,i) = rÌ„(i) + Î£(sim(i,j) * (r(u,j) - rÌ„(j))) / Î£|sim(i,j)|
```

**ç®—æ³•ç‰¹æ€§ï¼š**
- ç‰©å“-ç‰©å“ç›¸ä¼¼åº¦è®¡ç®—
- é€‚ç”¨äºç”¨æˆ·å¤šäºç‰©å“çš„åœºæ™¯
- æä¾›å¯è§£é‡Šçš„æ¨èç»“æœ
- æ—¶é—´ç¨³å®šæ€§å¥½

## ğŸ“ˆ è¯„ä¼°æŒ‡æ ‡

### è¯„åˆ†é¢„æµ‹æŒ‡æ ‡
- **MAE**ï¼ˆå¹³å‡ç»å¯¹è¯¯å·®ï¼‰
- **RMSE**ï¼ˆå‡æ–¹æ ¹è¯¯å·®ï¼‰
- **NMAE**ï¼ˆå½’ä¸€åŒ–å¹³å‡ç»å¯¹è¯¯å·®ï¼‰
- **çš®å°”é€Šç›¸å…³ç³»æ•°**

### æ’åºè¯„ä¼°æŒ‡æ ‡
- **Precision@K**ï¼šæ¨èç‰©å“ä¸­ç›¸å…³ç‰©å“çš„æ¯”ä¾‹
- **Recall@K**ï¼šç›¸å…³ç‰©å“ä¸­è¢«æ¨èç‰©å“çš„æ¯”ä¾‹
- **F1@K**ï¼šPrecision å’Œ Recall çš„è°ƒå’Œå¹³å‡
- **NDCG@K**ï¼šå½’ä¸€åŒ–æŠ˜æŸç´¯ç§¯å¢ç›Š
- **Hit Rate@K**ï¼šæ˜¯å¦å‘½ä¸­ç›¸å…³ç‰©å“

### å¤šæ ·æ€§æŒ‡æ ‡
- **Coverage**ï¼šæ¨èä¸­å‡ºç°çš„ç‰©å“è¦†ç›–ç‡
- **Novelty**ï¼šæ¨èç‰©å“çš„æ–°é¢–åº¦

## ğŸ”§ é…ç½®ç³»ç»Ÿ

ç³»ç»Ÿä½¿ç”¨å…¨é¢çš„é…ç½®ç®¡ç†ç³»ç»Ÿï¼ˆ`config.py`ï¼‰ï¼ŒåŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š

- **æ•°æ®é…ç½®**ï¼šæ•°æ®é›†è·¯å¾„ã€é¢„å¤„ç†å‚æ•°
- **æ¨¡å‹é…ç½®**ï¼šç›¸ä¼¼åº¦åº¦é‡ã€é‚»åŸŸå¤§å°
- **è¯„ä¼°é…ç½®**ï¼šè®¡ç®—æŒ‡æ ‡ã€Kå€¼è®¾ç½®
- **å¯è§†åŒ–é…ç½®**ï¼šå›¾è¡¨è®¾ç½®ã€è¾“å‡ºæ ¼å¼
- **å®éªŒé…ç½®**ï¼šæ—¥å¿—è®°å½•ã€ç»“æœå­˜å‚¨ã€å¯é‡ç°æ€§

### é…ç½®ç¤ºä¾‹

```python
from config import cfg

# ä¿®æ”¹é…ç½®å‚æ•°
cfg.model.user_k_neighbors = 100
cfg.evaluation.top_k_recommendations = [5, 10, 20, 50]
cfg.model.similarity_metric = "pearson"
```

## ğŸ“Š å¯è§†åŒ–ç³»ç»Ÿ

ç³»ç»Ÿç”Ÿæˆå‘è¡¨çº§åˆ«çš„å¯è§†åŒ–ç»“æœï¼š

### é™æ€å›¾è¡¨
- æ•°æ®é›†ç»Ÿè®¡å’Œåˆ†å¸ƒåˆ†æ
- æ¨¡å‹æ€§èƒ½å¯¹æ¯”
- ç›¸ä¼¼åº¦çŸ©é˜µçƒ­åŠ›å›¾
- è¯„åˆ†åˆ†å¸ƒåˆ†æ
- æ€§èƒ½æŒ‡æ ‡è¶‹åŠ¿å›¾

### äº¤äº’å¼ä»ªè¡¨æ¿
- åŸºäº Plotly çš„äº¤äº’å¼åˆ†æ
- æ¨¡å‹å¯¹æ¯”å·¥å…·
- æ·±å…¥åˆ†æåŠŸèƒ½
- ç»“æœå¯¼å‡ºåŠŸèƒ½

## ğŸ”¬ å­¦æœ¯ç‰¹æ€§

### ç ”ç©¶æ ‡å‡†
- æ—¶é—´æˆ³å®Œæ•´æ—¥å¿—è®°å½•
- å¯é‡ç°éšæœºç§å­
- ç»Ÿè®¡æ˜¾è‘—æ€§æ£€éªŒ
- è¯¦ç»†å®éªŒæ–‡æ¡£

### è½¯ä»¶å·¥ç¨‹
- æ¨¡å—åŒ–å¯æ‰©å±•æ¶æ„
- ç±»å‹æç¤ºå’Œæ–‡æ¡£
- é”™è¯¯å¤„ç†å’ŒéªŒè¯
- å•å…ƒæµ‹è¯•å…¼å®¹æ€§

### è¾“å‡ºæ ¼å¼
- JSON ç»“æœä¾¿äºç¨‹åºè®¿é—®
- CSV æ‘˜è¦ä¾¿äºè¡¨æ ¼åˆ†æ
- å­¦æœ¯å›¾è¡¨ï¼ˆPNGã€PDFï¼‰
- äº¤äº’å¼ HTML ä»ªè¡¨æ¿

## ğŸ“¥ æ•°æ®è¦æ±‚

### è‡ªåŠ¨ä¸‹è½½ï¼ˆæ¨èï¼‰

ç³»ç»Ÿè‡ªåŠ¨ä¸‹è½½å’Œå¤„ç† MovieLens æ•°æ®é›†ï¼Œæ— éœ€æ‰‹åŠ¨è®¾ç½®ï¼

åªéœ€è¿è¡Œï¼š
```bash
python main.py --quick-test  # è‡ªåŠ¨ä¸‹è½½ ml-latest-small
```

### æ‰‹åŠ¨è®¾ç½®ï¼ˆå¯é€‰ï¼‰

å¦‚æœæ‚¨åå¥½æ‰‹åŠ¨è®¾ç½®ï¼Œè¯·ä» [GroupLens](https://grouplens.org/datasets/movielens/) ä¸‹è½½ï¼š

1. ä¸‹è½½ MovieLens æ•°æ®é›†ï¼ˆml-latest-small æˆ– ml-latestï¼‰
2. è§£å‹åˆ° `./data/` ç›®å½•
3. ç¡®ä¿ `ratings.csv` å’Œ `movies.csv` æ–‡ä»¶å­˜åœ¨
4. è¿è¡Œæ—¶ä½¿ç”¨ `--no-download` æ ‡å¿—

### æ•°æ®æ ¼å¼

**ratings.csv:**
```
userId,movieId,rating,timestamp
1,1,4.0,964982703
1,3,4.0,964981247
```

**movies.csv:**
```
movieId,title,genres
1,Toy Story (1995),Adventure|Animation|Children|Comedy|Fantasy
2,Jumanji (1995),Adventure|Children|Fantasy
```

## ğŸƒâ€â™‚ï¸ é«˜çº§ç”¨æ³•

### è‡ªå®šä¹‰è¯„ä¼°

```python
from evaluation.metrics import MetricsEvaluator
from models.user_based_cf import UserBasedCollaborativeFiltering

# åˆå§‹åŒ–æ¨¡å‹å’Œè¯„ä¼°å™¨
model = UserBasedCollaborativeFiltering(similarity_metric="cosine", k_neighbors=50)
evaluator = MetricsEvaluator()

# è®­ç»ƒæ¨¡å‹
model.fit(user_item_matrix)

# ç»¼åˆè¯„ä¼°
results = evaluator.comprehensive_evaluation(
    model=model,
    test_data=test_df,
    user_item_matrix=user_item_matrix,
    k_values=[5, 10, 20],
    threshold=3.5
)
```

### è‡ªå®šä¹‰ç›¸ä¼¼åº¦åº¦é‡

```python
# æ‰©å±•åŸºç±»å®ç°è‡ªå®šä¹‰ç›¸ä¼¼åº¦
class CustomCF(BaseCollaborativeFiltering):
    def compute_similarity_matrix(self, data_matrix):
        # å®ç°è‡ªå®šä¹‰ç›¸ä¼¼åº¦è®¡ç®—
        pass
```

### æ‰¹é‡é¢„æµ‹

```python
# é«˜æ•ˆæ‰¹é‡é¢„æµ‹
user_item_pairs = [(1, 100), (1, 200), (2, 100)]
predictions = model.predict_batch(user_item_pairs)
```

## ğŸ“š å­¦æœ¯å‚è€ƒ

æœ¬å®ç°éµå¾ªå·²å»ºç«‹çš„ç ”ç©¶æ–¹æ³•è®ºï¼š

1. **ååŒè¿‡æ»¤åŸºç¡€**
   - Resnick, P., et al. (1994). GroupLens: An open architecture for collaborative filtering of netnews
   - Herlocker, J. L., et al. (1999). An algorithmic framework for performing collaborative filtering

2. **åŸºäºç‰©å“çš„æ–¹æ³•**
   - Sarwar, B., et al. (2001). Item-based collaborative filtering recommendation algorithms
   - Deshpande, M., & Karypis, G. (2004). Item-based top-n recommendation algorithms

3. **è¯„ä¼°æ–¹æ³•è®º**
   - Herlocker, J. L., et al. (2004). Evaluating collaborative filtering recommender systems
   - Shani, G., & Gunawardana, A. (2011). Evaluating recommendation systems

## ğŸ¤ è´¡çŒ®æŒ‡å—

æœ¬é¡¹ç›®éµå¾ªå­¦æœ¯è½¯ä»¶å¼€å‘æ ‡å‡†ï¼š

1. **ä»£ç è´¨é‡**ï¼šPEP 8 è§„èŒƒã€ç±»å‹æç¤ºã€æ–‡æ¡£æ³¨é‡Š
2. **æµ‹è¯•**ï¼šæ‰€æœ‰ç»„ä»¶çš„å•å…ƒæµ‹è¯•
3. **æ–‡æ¡£**ï¼šéµå¾ªå­¦æœ¯æ ‡å‡†çš„æ–‡æ¡£å­—ç¬¦ä¸²
4. **å¯é‡ç°æ€§**ï¼šå›ºå®šéšæœºç§å­ã€å…¨é¢æ—¥å¿—è®°å½•





## ğŸ“ ä½¿ç”¨è¯´æ˜

### æœ€ç®€å•çš„å¼€å§‹æ–¹å¼

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd Movie-CF-Recommender

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# å¼€å§‹å®éªŒï¼ˆè‡ªåŠ¨ä¸‹è½½æ•°æ®ï¼‰
python main.py --quick-test
```

### é¢„æœŸè¾“å‡º

è¿è¡Œåå°†ç”Ÿæˆï¼š
- `./results/`: å®éªŒç»“æœï¼ˆJSONã€CSVæ ¼å¼ï¼‰
- `./plots/`: å¯è§†åŒ–å›¾è¡¨ï¼ˆPNGã€PDFæ ¼å¼ï¼‰
- `./logs/`: è¯¦ç»†æ—¥å¿—æ–‡ä»¶

### æ•…éšœæ’é™¤

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼ˆç”¨äºè‡ªåŠ¨ä¸‹è½½ï¼‰
2. å°è¯•ä½¿ç”¨ `--dataset ml-100k`ï¼ˆè¾ƒå°æ•°æ®é›†ï¼‰
3. ä½¿ç”¨ `--no-download` å¹¶æ‰‹åŠ¨ä¸‹è½½æ•°æ®
4. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯